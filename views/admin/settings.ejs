<%- include("navbar.ejs") %>
<style>
  /* General Body */
  body {
    background-color: #f8f9fa; /* Light gray background */
    color: #212529; /* Dark text */
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  /* Container */
  .container {
    background-color: #ffffff; /* White card background */
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  }

  h3 {
    color: #212529;
    font-weight: 600;
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 8px;
    margin-bottom: 20px;
  }

  /* Tabs Navigation */
  .nav-tabs {
    border-bottom: 2px solid #dee2e6;
  }

  .nav-tabs .nav-link {
    color: #495057;
    font-weight: 500;
    background-color: #f8f9fa;
    border: 1px solid transparent;
    margin-right: 5px;
    border-radius: 8px 8px 0 0;
    transition: all 0.3s ease;
  }

  .nav-tabs .nav-link:hover {
    background-color: #e9ecef;
    color: #212529;
  }

  .nav-tabs .nav-link.active {
    background-color: #ffffff;
    color: #212529;
    border-color: #dee2e6 #dee2e6 #ffffff;
    font-weight: 600;
  }

  /* Form Labels */
  .form-label {
    color: #495057;
    font-weight: 500;
  }

  /* Form Controls */
  .form-control {
    background-color: #ffffff;
    color: #212529;
    border: 1px solid #ced4da;
    border-radius: 8px;
    transition: all 0.3s ease;
    box-shadow: none;
  }

  .form-control:focus {
    border-color: #4c9aff;
    box-shadow: 0 0 8px rgba(76, 154, 255, 0.3);
    color: #212529;
  }

  /* Checkboxes */
  .form-check-label {
    color: #495057;
  }

  .form-check-input:checked {
    background-color: #4c9aff;
    border-color: #4c9aff;
  }

  /* Buttons */
  .btn-primary {
    background: linear-gradient(90deg, #4c9aff, #6bb0ff);
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: 500;
    color: #fff;
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    background: linear-gradient(90deg, #3b7ee0, #5a9eff);
  }

  /* Textareas */
  textarea.form-control {
    resize: vertical;
  }

  /* Tabs Content */
  .tab-content {
    padding-top: 20px;
  }

  /* Scrollbar for light theme */
  ::-webkit-scrollbar {
    width: 8px;
  }

  ::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  ::-webkit-scrollbar-thumb {
    background-color: #ced4da;
    border-radius: 4px;
  }
</style>

<div class="container my-5">
  <h3 class="mb-4">Admin Settings</h3>
  
  <form action="/admin/save_settings" method="POST" enctype="multipart/form-data">
    
    <!-- Tabs Navigation -->
    <% const tabs = [
      { id: "site", label: "Site Info" },
      { id: "contact", label: "Contact Info" },
      { id: "localization", label: "Localization" },
      { id: "security", label: "Security" },
      { id: "email", label: "Email & Notifications" },
      { id: "payment", label: "Payment" },
      { id: "seo", label: "SEO & Analytics" },
      { id: "misc", label: "Miscellaneous" }
    ]; %>

    <ul class="nav nav-tabs mb-4" id="settingsTab" role="tablist">
      <% tabs.forEach((tab, index) => { %>
        <li class="nav-item" role="presentation">
          <button class="nav-link <%= index === 0 ? 'active' : '' %>" 
                  id="<%= tab.id %>-tab" 
                  data-bs-toggle="tab" 
                  data-bs-target="#<%= tab.id %>" 
                  type="button" 
                  role="tab"
                  aria-controls="<%= tab.id %>" 
                  aria-selected="<%= index === 0 ? 'true' : 'false' %>">
            <%= tab.label %>
          </button>
        </li>
      <% }) %>
    </ul>

    <!-- Tabs Content -->
    <div class="tab-content">

      <!-- Site Info -->
      <div class="tab-pane fade show active" id="site">
        <div class="mb-3">
          <label class="form-label">Site Name</label>
          <input type="text" class="form-control" name="site_name" value="<%= settings.site_name %>">
        </div>
        <div class="mb-3">
          <label class="form-label">Site Logo</label>
          <input type="file" class="form-control" name="site_logo">
        </div>
        <div class="mb-3">
          <label class="form-label">Favicon</label>
          <input type="file" class="form-control" name="favicon">
        </div>
        <div class="mb-3">
          <label class="form-label">Tagline / Description</label>
          <textarea class="form-control" name="description" rows="3"><%= settings.description %></textarea>
        </div>
      </div>

      <!-- Contact Info -->
      <div class="tab-pane fade" id="contact">
        <div class="mb-3">
          <label class="form-label">Email</label>
          <input type="email" class="form-control" name="contact_email" value="<%= settings.contact_email %>">
        </div>
        <div class="mb-3">
          <label class="form-label">Phone Number</label>
          <input type="text" class="form-control" name="contact_phone" value="<%= settings.contact_phone %>">
        </div>
        <div class="mb-3">
          <label class="form-label">Address</label>
          <textarea class="form-control" name="contact_address" rows="3"><%= settings.contact_address %></textarea>
        </div>
        <% const socialMedia = ["facebook","twitter","instagram","linkedin"]; %>
        <div class="mb-3">
          <label class="form-label">Social Media Links</label>
          <% socialMedia.forEach(sm => { %>
            <input type="text" class="form-control mb-1" name="<%= sm %>" placeholder="<%= sm.charAt(0).toUpperCase() + sm.slice(1) %>" value="<%= settings[sm] %>">
          <% }) %>
        </div>
      </div>

      <!-- Localization -->
      <div class="tab-pane fade" id="localization">
        <% const localizationFields = [
          { label: "Time Zone", name: "timezone" },
          { label: "Date Format", name: "date_format" },
          { label: "Currency", name: "currency" },
          { label: "Language", name: "language" }
        ]; %>
        <% localizationFields.forEach(f => { %>
          <div class="mb-3">
            <label class="form-label"><%= f.label %></label>
            <input type="text" class="form-control" name="<%= f.name %>" value="<%= settings[f.name] %>">
          </div>
        <% }) %>
      </div>

      <!-- Security -->
      <div class="tab-pane fade" id="security">
        <div class="mb-3">
          <label class="form-label">Admin Password</label>
          <input type="password" class="form-control" name="admin_password" placeholder="Enter new password">
        </div>
        <div class="form-check mb-3">
          <input type="checkbox" class="form-check-input" name="enable_2fa" <%= settings.enable_2fa ? 'checked' : '' %>>
          <label class="form-check-label">Enable Two-Factor Authentication</label>
        </div>
        <div class="form-check mb-3">
          <input type="checkbox" class="form-check-input" name="enable_captcha" <%= settings.enable_captcha ? 'checked' : '' %>>
          <label class="form-check-label">Enable Captcha</label>
        </div>
        <div class="mb-3">
          <label class="form-label">Session Timeout (minutes)</label>
          <input type="number" class="form-control" name="session_timeout" value="<%= settings.session_timeout %>">
        </div>
      </div>

      <!-- Email & Notifications -->
      <div class="tab-pane fade" id="email">
        <% const emailFields = [
          { label: "SMTP Host", name: "smtp_host", type: "text" },
          { label: "SMTP Port", name: "smtp_port", type: "text" },
          { label: "SMTP Email", name: "smtp_email", type: "email" },
          { label: "SMTP Password", name: "smtp_password", type: "password" }
        ]; %>
        <% emailFields.forEach(f => { %>
          <div class="mb-3">
            <label class="form-label"><%= f.label %></label>
            <input type="<%= f.type %>" class="form-control" name="<%= f.name %>" value="<%= f.name === 'smtp_password' ? '' : settings[f.name] %>">
          </div>
        <% }) %>
      </div>

      <!-- Payment -->
      <div class="tab-pane fade" id="payment">
        <% const paymentFields = [
          { label: "Payment Gateway API Key", name: "payment_api" },
          { label: "Currency Symbol", name: "currency_symbol" },
          { label: "Tax / GST (%)", name: "tax", type: "number" }
        ]; %>
        <% paymentFields.forEach(f => { %>
          <div class="mb-3">
            <label class="form-label"><%= f.label %></label>
            <input type="<%= f.type || 'text' %>" class="form-control" name="<%= f.name %>" value="<%= settings[f.name] %>">
          </div>
        <% }) %>
      </div>

      <!-- SEO & Analytics -->
      <div class="tab-pane fade" id="seo">
        <div class="mb-3">
          <label class="form-label">Meta Title</label>
          <input type="text" class="form-control" name="meta_title" value="<%= settings.meta_title %>">
        </div>
        <div class="mb-3">
          <label class="form-label">Meta Description</label>
          <textarea class="form-control" name="meta_description" rows="3"><%= settings.meta_description %></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Google Analytics ID</label>
          <input type="text" class="form-control" name="google_analytics" value="<%= settings.google_analytics %>">
        </div>
      </div>

      <!-- Miscellaneous -->
      <div class="tab-pane fade" id="misc">
        <% const miscFields = [
          { label: "Terms & Conditions URL", name: "terms_url" },
          { label: "Privacy Policy URL", name: "privacy_url" },
          { label: "Custom Header Scripts", name: "header_scripts", type: "textarea" },
          { label: "Custom Footer Scripts", name: "footer_scripts", type: "textarea" }
        ]; %>
        <% miscFields.forEach(f => { %>
          <div class="mb-3">
            <label class="form-label"><%= f.label %></label>
            <% if(f.type === "textarea"){ %>
              <textarea class="form-control" name="<%= f.name %>" rows="3"><%= settings[f.name] %></textarea>
            <% } else { %>
              <input type="text" class="form-control" name="<%= f.name %>" value="<%= settings[f.name] %>">
            <% } %>
          </div>
        <% }) %>
        <div class="form-check mb-3">
          <input type="checkbox" class="form-check-input" name="maintenance_mode" <%= settings.maintenance_mode ? 'checked' : '' %>>
          <label class="form-check-label">Enable Maintenance Mode</label>
        </div>
      </div>

    </div>

    <div class="mt-4">
      <button type="submit" class="btn btn-primary">Save Settings</button>
    </div>
  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<%- include("footer.ejs") %>
